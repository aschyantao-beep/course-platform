<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>海外运营培训课程教学平台</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- 引入Supabase CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="nav-container">
                <h1 class="logo">海外运营培训课程</h1>
                <ul class="nav-menu">
                    <li><a href="#home">首页</a></li>
                    <li><a href="#courses">课程</a></li>
                    <li><a href="learning-center.html" class="learning-center-link">
                        <i class="fas fa-book-open"></i>
                        <span>学习中心</span>
                    </a></li>
                    <li><a href="quiz.html">课后测验</a></li>
                    <li class="user-menu-item">
                        <a href="auth.html" class="user-login-link">
                            <i class="fas fa-user"></i>
                            <span class="login-text">登录/注册</span>
                        </a>
                        <div class="user-dropdown" id="user-dropdown" style="display: none;">
                            <div class="user-info">
                                <div class="user-avatar">
                                    <i class="fas fa-user-circle"></i>
                                </div>
                                <div class="user-details">
                                    <div class="user-name" id="current-user-name">游客</div>
                                    <div class="user-email" id="current-user-email">未登录</div>
                                </div>
                            </div>
                            <div class="user-actions">
                                <a href="#" class="action-btn" id="logout-btn" style="display: none;">
                                    <i class="fas fa-sign-out-alt"></i>
                                    退出登录
                                </a>
                            </div>
                        </div>
                    </li>
                    <li><a href="admin/login.html" class="admin-link">管理员</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main>
        <section id="hero" class="hero">
            <div class="hero-content">
                <h2>开启您的学习之旅</h2>
                <p>十期海外运营培训课程，助您掌握业务运营技能</p>
                <div class="hero-buttons">
                    <a href="learning-center.html" class="cta-button learning-center-btn">
                        <i class="fas fa-book-open"></i> 进入学习中心
                    </a>
                    <a href="#courses" class="cta-button">
                        <i class="fas fa-graduation-cap"></i> 浏览课程
                    </a>
                </div>
            </div>
        </section>



        <section id="courses" class="courses">
            <div class="container">
                <h2 class="section-title">课程列表</h2>
                <div class="courses-grid">
                    <div class="course-card" data-course="1">
                        <div class="course-image">
                            <img src="assets/course1.jpg" alt="业务职责&学员生命周期">
                        </div>
                        <div class="course-content">
                            <h3>业务职责&学员生命周期</h3>
                            <a href="https://iu8uoujh41.feishu.cn/minutes/obcnvgz5sjqi137t5k857duk?from=from_copylink" class="course-link" target="_blank" data-course-id="1">开始学习</a>
                            <div class="learning-stats">
                                <span class="time-label">学习时长：</span>
                                <div class="progress-bar-container">
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="progress-course-1" style="width: 0%"></div>
                                    </div>
                                    <span class="progress-text" id="progress-text-1">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="course-card" data-course="2">
                        <div class="course-image">
                            <img src="assets/course2.jpg" alt="学员管理&业务绩效&产品规则">
                        </div>
                        <div class="course-content">
                            <h3>学员管理&业务绩效&产品规则</h3>
                            <a href="https://iu8uoujh41.feishu.cn/minutes/obcnv41l2x5lo27q9671p939?from=from_copylink" class="course-link" target="_blank" data-course-id="2">开始学习</a>
                            <div class="learning-stats">
                                <span class="time-label">学习时长：</span>
                                <div class="progress-bar-container">
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="progress-course-2" style="width: 0%"></div>
                                    </div>
                                    <span class="progress-text" id="progress-text-2">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="course-card" data-course="3">
                        <div class="course-image">
                            <img src="assets/course3.jpg" alt="下标逻辑&学员权益">
                        </div>
                        <div class="course-content">
                            <h3>下标逻辑&学员权益</h3>
                            <a href="https://iu8uoujh41.feishu.cn/minutes/obcnwtfw65uymh273jd5amh6" class="course-link" target="_blank" data-course-id="3">开始学习</a>
                            <div class="learning-stats">
                                <span class="time-label">学习时长：</span>
                                <div class="progress-bar-container">
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="progress-course-3" style="width: 0%"></div>
                                    </div>
                                    <span class="progress-text" id="progress-text-3">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="course-card" data-course="4">
                        <div class="course-image">
                            <img src="assets/course4.jpg" alt="运营定位&目标拆解&围场运营">
                        </div>
                        <div class="course-content">
                            <h3>运营定位&目标拆解&围场运营</h3>
                            <a href="https://iu8uoujh41.feishu.cn/minutes/obcnix9db63113ih6jad13z8" class="course-link" target="_blank" data-course-id="4">开始学习</a>
                            <div class="learning-stats">
                                <span class="time-label">学习时长：</span>
                                <div class="progress-bar-container">
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="progress-course-4" style="width: 0%"></div>
                                    </div>
                                    <span class="progress-text" id="progress-text-4">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="course-card" data-course="5">
                        <div class="course-image">
                            <img src="assets/course5.jpg" alt="排兵案例">
                        </div>
                        <div class="course-content">
                            <h3>排兵案例</h3>
                            <a href="https://iu8uoujh41.feishu.cn/minutes/obcni2gt134ddov6roiod529" class="course-link" target="_blank" data-course-id="5">开始学习</a>
                            <div class="learning-stats">
                                <span class="time-label">学习时长：</span>
                                <div class="progress-bar-container">
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="progress-course-5" style="width: 0%"></div>
                                    </div>
                                    <span class="progress-text" id="progress-text-5">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="course-card" data-course="6">
                        <div class="course-image">
                            <img src="assets/course6.jpg" alt="促销管理PDCA">
                        </div>
                        <div class="course-content">
                            <h3>促销管理PDCA</h3>
                            <a href="https://iu8uoujh41.feishu.cn/minutes/obcnjmpb8h9ndf2hqur8q1s8" class="course-link" target="_blank" data-course-id="6">开始学习</a>
                            <div class="learning-stats">
                                <span class="time-label">学习时长：</span>
                                <div class="progress-bar-container">
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="progress-course-6" style="width: 0%"></div>
                                    </div>
                                    <span class="progress-text" id="progress-text-6">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="course-card" data-course="7">
                        <div class="course-image">
                            <img src="assets/course7.jpg" alt="促销管理实操">
                        </div>
                        <div class="course-content">
                            <h3>促销管理实操</h3>
                            <a href="https://iu8uoujh41.feishu.cn/minutes/obcnjrhwk94skof4cz6h584q" class="course-link" target="_blank" data-course-id="7">开始学习</a>
                            <div class="learning-stats">
                                <span class="time-label">学习时长：</span>
                                <div class="progress-bar-container">
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="progress-course-7" style="width: 0%"></div>
                                    </div>
                                    <span class="progress-text" id="progress-text-7">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="course-card" data-course="8">
                        <div class="course-image">
                            <img src="assets/course8.jpg" alt="激励管理">
                        </div>
                        <div class="course-content">
                            <h3>激励管理</h3>
                            <a href="https://iu8uoujh41.feishu.cn/minutes/obcnlng5rz8s8ummv9jkuh59" class="course-link" target="_blank" data-course-id="8">开始学习</a>
                            <div class="learning-stats">
                                <span class="time-label">学习时长：</span>
                                <div class="progress-bar-container">
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="progress-course-8" style="width: 0%"></div>
                                    </div>
                                    <span class="progress-text" id="progress-text-8">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="course-card" data-course="9">
                        <div class="course-image">
                            <img src="assets/course9.jpg" alt="新建组SOP&会议管理">
                        </div>
                        <div class="course-content">
                            <h3>新建组SOP&会议管理</h3>
                            <a href="https://iu8uoujh41.feishu.cn/minutes/obcnlsruwn56m5d3v55udw81" class="course-link" target="_blank" data-course-id="9">开始学习</a>
                            <div class="learning-stats">
                                <span class="time-label">学习时长：</span>
                                <div class="progress-bar-container">
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="progress-course-9" style="width: 0%"></div>
                                    </div>
                                    <span class="progress-text" id="progress-text-9">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="course-card" data-course="10">
                        <div class="course-image">
                            <img src="assets/course10.jpg" alt="数据看板">
                        </div>
                        <div class="course-content">
                            <h3>数据看板</h3>
                            <a href="https://iu8uoujh41.feishu.cn/minutes/obcnxz3c7543428d463l45wt" class="course-link" target="_blank" data-course-id="10">开始学习</a>
                            <div class="learning-stats">
                                <span class="time-label">学习时长：</span>
                                <div class="progress-bar-container">
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="progress-course-10" style="width: 0%"></div>
                                    </div>
                                    <span class="progress-text" id="progress-text-10">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>


    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 海外运营培训课程教学平台. 保留所有权利.</p>
        </div>
    </footer>

    <!-- Supabase客户端必须首先加载 -->
    <script src="js/supabase-client.js"></script>
    <!-- 添加简单的用户状态检测脚本 -->
    <script>
        // 等待Supabase初始化并检查用户状态
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('首页开始检查用户状态...');

            // 等待Supabase初始化
            const checkSupabase = () => {
                if (window.supabaseClientInitialized) {
                    checkUserStatus();
                } else {
                    setTimeout(checkSupabase, 100);
                }
            };
            checkSupabase();
        });

        async function checkUserStatus() {
            try {
                console.log('开始检查认证状态...');
                const { data: { session }, error } = await window.supabase.auth.getSession();

                if (error) {
                    console.error('检查认证状态失败:', error);
                    return;
                }

                if (session && session.user) {
                    console.log('用户已登录:', session.user.email);
                    updateUserUI(session.user);
                } else {
                    console.log('用户未登录');
                    updateUserUI(null);
                }
            } catch (error) {
                console.error('用户状态检查异常:', error);
            }
        }

        function updateUserUI(user) {
            const loginLink = document.querySelector('.user-login-link');
            const dropdown = document.getElementById('user-dropdown');
            const userName = document.getElementById('current-user-name');
            const userEmail = document.getElementById('current-user-email');

            if (user) {
                // 显示用户信息
                if (userName) userName.textContent = user.user_metadata?.name || user.email.split('@')[0];
                if (userEmail) userEmail.textContent = user.email;

                if (loginLink) {
                    loginLink.style.display = 'none';
                }
                if (dropdown) {
                    dropdown.style.display = 'block';
                }
                console.log('用户界面更新完成');
            } else {
                // 显示登录链接
                if (loginLink) {
                    loginLink.style.display = 'block';
                }
                if (dropdown) {
                    dropdown.style.display = 'none';
                }
            }
        }
    </script>
    <!-- 然后加载用户管理和学习追踪器 -->
    <script src="js/user-manager.js"></script>
    <script src="js/learning-tracker.js"></script>
    <script src="js/course-progress.js"></script>
    <script src="js/learning-timer.js"></script>
    <script src="js/main.js"></script>
</body>
</html>